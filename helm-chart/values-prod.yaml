# Production Environment Configuration
# This file contains settings optimized for production cloud deployments
# Higher replica count, proper registry, and strict resource limits

replicaCount: 5  # Multiple replicas for high availability

image:
  repository: your-registry.azurecr.io/embassy-appointments  # Replace with your registry
  tag: "1.0.0"          # Use specific version tags (not 'latest')
  pullPolicy: IfNotPresent  # Pull only if not cached

imagePullSecrets:
  - name: acr-secret    # Secret for accessing private container registry

config:
  environment: "production"
  logLevel: "WARNING"

secrets:
  # These should be set via secure methods (e.g., sealed-secrets, external-secrets)
  secretKey: ""  # Override via --set or external secrets
  databasePassword: ""  # Override if using external database

autoscaling:
  enabled: true
  minReplicas: 5
  maxReplicas: 20
  targetCPUUtilizationPercentage: 60
  targetMemoryUtilizationPercentage: 75

podDisruptionBudget:
  enabled: true
  minAvailable: 3

ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
  hosts:
    - host: appointments.embassy.gov
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: appointments-tls-prod
      hosts:
        - appointments.embassy.gov

resources:
  limits:
    cpu: 1000m
    memory: 512Mi
  requests:
    cpu: 500m
    memory: 256Mi

persistence:
  enabled: true
  storageClass: "premium-ssd"
  size: 10Gi

networkPolicy:
  enabled: true

serviceMonitor:
  enabled: true
